{% extends 'home/base.html' %}

{% load static %}

{% block title %}Shop - FreshMart{% endblock %}

{% block content %}
<main>

  <form method="get" class="shop-controls">
    <div class="filter-control">
      <label for="category-filter">Filter by Category:</label>
      <select id="category-filter" name="category" onchange="this.form.submit()">
        <option value="all" {% if current_category == "all" or not current_category %}selected{% endif %}>
          All Categories
        </option>
        {% for category in categories %}
          <option value="{{ category.slug }}" {% if current_category == category.slug %}selected{% endif %}>
            {{ category.name }}
          </option>
        {% endfor %}
      </select>
    </div>
  
    <div class="sort-control">
      <label for="sort-options">Sort by:</label>
      <select id="sort-options" name="sort" onchange="this.form.submit()">
        <option value="default" {% if sort_by == "default" %}selected{% endif %}>Default</option>
        <option value="price-asc" {% if sort_by == "price-asc" %}selected{% endif %}>Price: Low to High</option>
        <option value="price-desc" {% if sort_by == "price-desc" %}selected{% endif %}>Price: High to Low</option>
        <option value="name-asc" {% if sort_by == "name-asc" %}selected{% endif %}>Name: A-Z</option>
        <option value="name-desc" {% if sort_by == "name-desc" %}selected{% endif %}>Name: Z-A</option>
      </select>
    </div>
  </form>
  
    <div class="product-grid">
        {% for item in products %}
            <div class="product-card">
                    <a href="{% url 'product:product_detail' item.slug %}">
                    <img src="{{ item.image.url }}" alt="{{ item.name }}">
                    <h3>{{ item.name }}</h3>
                </a>
                <p class="price">${{ item.price }}</p>
            </div>
        {% empty %}
            <p>No products available right now.</p>
        {% endfor %}
    </div>
</section>

</main>
{% endblock %}