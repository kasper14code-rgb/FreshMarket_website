{% extends 'dashboard/dashboard.html' %}
{% load static %}

{% block content %}
<div class="dashboard-container">
    <div class="sidebar">
        <div class="logo">
            <i class="fas fa-shopping-basket" style="color: #4CAF50; font-size: 28px;"></i>
            <h1>Fresh<span>Mart</span></h1>
        </div>
        <ul class="nav-links">
            <li><a href="{% url 'dashboard:dashboard' %}"><i class="fas fa-home"></i> <span>Dashboard</span></a></li>
            <li class="active"><a href="{% url 'dashboard:product_list' %}"><i class="fas fa-box-open"></i> <span>Products</span></a></li>
            <li><a href="{% url 'dashboard:order_list' %}"><i class="fas fa-shopping-cart"></i> <span>Orders</span></a></li>
            <li><a href="{% url 'dashboard:customer_list' %}"><i class="fas fa-users"></i> <span>Customers</span></a></li>
            <li><a href="{% url 'dashboard:category_management' %}"><i class="fas fa-tags"></i> <span>Categories</span></a></li>
        </ul>
    </div>

    <div class="main-content">
        <div class="header">
            <h2>{{ page_title }}</h2>
            <a href="{% url 'dashboard:product_list' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Products
            </a>
        </div>

        {% if messages %}
        <div class="messages-container">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
                <button class="close-btn" onclick="this.parentElement.style.display='none';">&times;</button>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <div class="form-container">
            <form method="post" enctype="multipart/form-data" class="product-form">
                {% csrf_token %}
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="{{ form.name.id_for_label }}">Product Name *</label>
                        {{ form.name }}
                        {% if form.name.errors %}
                        <div class="error">{{ form.name.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.category.id_for_label }}">Category *</label>
                        {{ form.category }}
                        {% if form.category.errors %}
                        <div class="error">{{ form.category.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.price.id_for_label }}">Price *</label>
                        {{ form.price }}
                        {% if form.price.errors %}
                        <div class="error">{{ form.price.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.unit.id_for_label }}">Unit *</label>
                        {{ form.unit }}
                        {% if form.unit.errors %}
                        <div class="error">{{ form.unit.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="{{ form.description.id_for_label }}">Description *</label>
                        {{ form.description }}
                        {% if form.description.errors %}
                        <div class="error">{{ form.description.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.stock.id_for_label }}">Stock Quantity *</label>
                        {{ form.stock }}
                        {% if form.stock.errors %}
                        <div class="error">{{ form.stock.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group">
                        <label for="{{ form.image.id_for_label }}">Product Image</label>
                        {{ form.image }}
                        {% if product and product.image %}
                        <div class="current-image">
                            <p>Current image:</p>
                            <img src="{{ product.image.url }}" alt="Current image" style="max-width: 200px; margin-top: 10px;">
                        </div>
                        {% endif %}
                        {% if form.image.errors %}
                        <div class="error">{{ form.image.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group checkbox-group">
                        {{ form.is_bestseller }}
                        <label for="{{ form.is_bestseller.id_for_label }}">Mark as Bestseller</label>
                    </div>
                    
                    <div class="form-group checkbox-group">
                        {{ form.is_active }}
                        <label for="{{ form.is_active.id_for_label }}">Active Product</label>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Product
                    </button>
                    <a href="{% url 'dashboard:product_list' %}" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}