{% extends 'dashboard/dashboard.html' %}
{% load static %}

{% block content %}
<div class="dashboard-container">
    <div class="sidebar">
        <div class="logo">
            <i class="fas fa-shopping-basket" style="color: #4CAF50; font-size: 28px;"></i>
            <h1>Fresh<span>Mart</span></h1>
        </div>
        <ul class="nav-links">
            <li><a href="{% url 'dashboard:dashboard' %}"><i class="fas fa-home"></i> <span>Dashboard</span></a></li>
            <li><a href="{% url 'dashboard:product_list' %}"><i class="fas fa-box-open"></i> <span>Products</span></a></li>
            <li><a href="{% url 'dashboard:order_list' %}"><i class="fas fa-shopping-cart"></i> <span>Orders</span></a></li>
            <li><a href="{% url 'dashboard:customer_list' %}"><i class="fas fa-users"></i> <span>Customers</span></a></li>
            <li class="active"><a href="{% url 'dashboard:category_management' %}"><i class="fas fa-tags"></i> <span>Categories</span></a></li>
        </ul>
    </div>

    <div class="main-content">
        <div class="header">
            <h2>{{ page_title }}</h2>
        </div>

        {% if messages %}
        <div class="messages-container">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
                <button class="close-btn" onclick="this.parentElement.style.display='none';">&times;</button>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Add Category Form -->
        <div class="chart-card">
            <h3>Add New Category</h3>
            <form method="post" enctype="multipart/form-data" class="category-form">
                {% csrf_token %}
                <div class="form-grid">
                    <div class="form-group">
                        <label for="{{ form.name.id_for_label }}">Category Name</label>
                        {{ form.name }}
                    </div>
                    <div class="form-group full-width">
                        <label for="{{ form.description.id_for_label }}">Description</label>
                        {{ form.description }}
                    </div>
                    <div class="form-group">
                        <label for="{{ form.image.id_for_label }}">Category Image</label>
                        {{ form.image }}
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Add Category
                    </button>
                </div>
            </form>
        </div>

        <!-- Categories List -->
        <div class="chart-card">
            <h3>Existing Categories</h3>
            <div class="categories">
                {% for category in categories %}
                <div class="category-card">
                    {% if category.image %}
                    <img src="{{ category.image.url }}" alt="{{ category.name }}" class="category-icon">
                    {% else %}
                    <div class="category-icon" style="background: {% cycle '#4CAF50' '#2196F3' '#FF9800' '#F44336' '#9C27B0' %};">
                        <i class="fas fa-tag"></i>
                    </div>
                    {% endif %}
                    <h3>{{ category.name }}</h3>
                    <p>{{ category.products.count }} products</p>
                </div>
                {% empty %}
                <p style="text-align: center; color: var(--text-color); opacity: 0.7; padding: 20px;">
                    No categories yet. Add your first category above.
                </p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}